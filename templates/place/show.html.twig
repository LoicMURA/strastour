{% extends 'base.html.twig' %}

{% set link = asset('assets/image/'~place.picture) %}
{% if link matches '{http(s)?://}' %}
    {% set link = place.picture %}
{% endif %}

{% block title %}{{ place.name }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    {% include'scripts/placeMap.html.twig' %}
{% endblock %}

{% block body %}
    <main class="main main__wrap">
        <a href="{{ path('course_show', {"id": course.id}) }}">
            <svg class="link__arrow link__arrow--left" viewBox="0 0 25.451 25.451">
                <path fill="currentColor" d="M20.982,0.521v2.006L8.57,12.315c-0.121,0.101-0.195,0.251-0.195,0.41s0.074,0.311,0.195,0.41l12.412,9.79v2.005 c0,0.199-0.115,0.383-0.297,0.469c-0.178,0.086-0.395,0.064-0.549-0.061L4.664,13.136c-0.122-0.1-0.194-0.251-0.194-0.41 s0.072-0.31,0.194-0.41L20.136,0.113c0.154-0.126,0.371-0.148,0.549-0.061C20.866,0.139,20.982,0.322,20.982,0.521z"/>
            </svg>
            Retourner au parcours
        </a>
        <div class="d-flex justify-content-between">
            <div id="mainDatas">
                <h1 class="mt-4 h2">{{ place.name }}</h1>
                <p>{{ place.address }}</p>
                <p>{{ place.longitude }} / {{ place.latitude }}</p>
                {% if not isPlayer or checkedPlace %}
                    <p>{{ place.description }}</p>
                    <img src="{{ link }}" alt="Image de {{ place.name }}">
                {% else %}
                    {% if is_granted('ROLE_USER') %}
                        <p id="js-unchecked">Vous devez vous rendre sur place pour avoir plus d'information</p>
                    {% endif %}
                {% endif %}
                {% if is_granted('ROLE_USER') and not checkedPlace and is_mobile() %}
                    <form action="{{ path('check_place', {"id": place.id}) }}">
                        <p id="js-geolocalisation" class="btn btn-primary">J'y suis</p>
                    </form>
                    <div id="geo"></div>
                {% endif %}
            </div>

            <div class="ml-5">
                <div class="mt-4" id="map"></div>
            </div>
        </div>
        <div class="links d-flex justify-content-between">
            {% if siblings.previous is defined %}
                <a class="nav__link nav__link--previous" href="{{ path('place_show', {"course": course.id , "id" : siblings.previous.id}) }}">Lieu précédent</a>
            {% endif %}
            {% if siblings.next is defined %}
                <a class="nav__link nav__link--next" href="{{ path('place_show', {"course": course.id , "id" : siblings.next.id}) }}">Lieu suivant</a>
            {% endif %}
        </div>
    </main>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://maps.googleapis.com/maps/api/js?key={{ API_KEY }}&callback=initMap"></script>
    {% include 'scripts/popup.html.twig' %}

    {% if is_mobile() %}
        {% include 'scripts/geolocation.html.twig' %}
    {% endif %}
{% endblock %}